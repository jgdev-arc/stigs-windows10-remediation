<#
.SYNOPSIS
    This PowerShell script ensures that the maximum size of the Windows Application event log is at least 32768 KB (32 MB), as required by STIG WN10-AU-000500.

.NOTES
    Author          : Jonathan Gistand
    LinkedIn        : https://linkedin.com/in/jgdev/
    GitHub          : https://github.com/jgdev-arc
    Date Created    : 2025-06-02
    Last Modified   : 2025-06-02
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AU-000500
#>

# Set Application event log max size to 32 MB (32768 KB)
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application"
$propertyName = "MaxSize"
$desiredValue = 32768

# Ensure key exists
if (-not (Test-Path $regPath)) {
    New-Item -Path $regPath -Force | Out-Null
}

# Apply setting
New-ItemProperty -Path $regPath -Name $propertyName -Value $desiredValue -PropertyType DWord -Force | Out-Null

Write-Output "✅ Application event log max size set to 32768 KB (V-220692)."


<#
README

# STIG: WN10-AU-000500 - Application Event Log Size

## 🔐 Overview

This STIG ensures the **Application event log** is configured with a **minimum size of 32 MB** to retain sufficient audit data for forensic analysis and troubleshooting.

- **STIG ID:** WN10-AU-000500  
- **Rule Title:** The Application event log size must be configured to at least 32768 KB.  
- **Required Value:** 32768 KB (32 MB)

## ⚙️ What This Script Does

- Creates the registry path if missing
- Sets `MaxSize` for the Application log to `32768` (KB)

#>
